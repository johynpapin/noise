webpackJsonp([1],{"4CKQ":function(t,n){},"7hNF":function(t,n){},"95AV":function(t,n){},NHnr:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i={};e.d(i,"SOCKET_CONNECT",function(){return q}),e.d(i,"SOCKET_DISCONNECT",function(){return J}),e.d(i,"SOCKET_STATE",function(){return Q}),e.d(i,"SOCKET_THINGS",function(){return W});var a=e("7+uW"),s={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]};var o=e("VU/8")({name:"App"},s,!1,function(t){e("vsZE")},null,null).exports,c=e("C/JF"),r=e("fhbW"),l=e("U0v6"),u=e("hMcO"),d=e.n(u),m=e("/ocq"),h=e("mvHQ"),p=e.n(h),k=e("NYxO"),v={name:"TrackItem",props:{name:String,selected:Boolean},data:function(){return{}}},f={render:function(){var t=this.$createElement,n=this._self._c||t;return n("a",{staticClass:"panel-block",class:[{"is-active":this.selected}]},[n("span",{staticClass:"panel-icon"},[n("fa",{attrs:{icon:"music"}})],1),this._v("\n  "+this._s(this.name)+"\n")])},staticRenderFns:[]},g=e("VU/8")(v,f,!1,null,null,null).exports,_={name:"Tracks",data:function(){return{addModalActive:!1,trackName:""}},computed:Object(k.c)({tracks:function(t){return t.state.tracks},selectedTrackName:function(t){return t.selectedTrackName}}),methods:{openAddModal:function(){this.trackName="",this.addModalActive=!0},closeAddModal:function(){this.addModalActive=!1},addTrack:function(){this.closeAddModal(),this.$socket.emit("createTrack",p()({name:this.trackName}))},selectTrack:function(t){this.$store.state.selectedTrackName=t},editMIDI:function(){this.$store.state.midi=!0}},components:{TrackItem:g}},b={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"tracks"}},[e("nav",{staticClass:"panel"},[e("p",{staticClass:"panel-heading"},[t._v("Tracks")]),t._v(" "),e("div",{staticClass:"panel-block"},[e("button",{staticClass:"button is-primary is-fullwidth",on:{click:t.openAddModal}},[e("span",{staticClass:"icon"},[e("fa",{attrs:{icon:"plus"}})],1),t._v(" "),e("span",[t._v("Add a track")])])]),t._v(" "),t._l(t.tracks,function(n,i){return e("track-item",{key:n.name,attrs:{name:n.name,selected:n.name===t.selectedTrackName},nativeOn:{click:function(e){t.selectTrack(n.name)}}})}),t._v(" "),e("div",{staticClass:"panel-block"},[e("button",{staticClass:"button is-primary is-fullwidth",on:{click:t.editMIDI}},[e("span",[t._v("Edit MIDI")])])])],2),t._v(" "),e("div",{staticClass:"modal",class:[{"is-active":t.addModalActive}]},[e("div",{staticClass:"modal-background",on:{click:t.closeAddModal}}),t._v(" "),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"box"},[e("h1",{staticClass:"title"},[t._v("Add a track")]),t._v(" "),e("form",{on:{submit:t.addTrack}},[e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Track name")]),t._v(" "),e("div",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.trackName,expression:"trackName"}],staticClass:"input",attrs:{type:"text",placeholder:"Track name"},domProps:{value:t.trackName},on:{input:function(n){n.target.composing||(t.trackName=n.target.value)}}})])]),t._v(" "),t._m(0)])])]),t._v(" "),e("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:t.closeAddModal}})])])},staticRenderFns:[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"control"},[n("button",{staticClass:"button is-primary"},[this._v("Add track")])])}]},C=e("VU/8")(_,b,!1,null,null,null).exports,y=e("BO1k"),N=e.n(y),T=e("Dd8w"),x=e.n(T),w={name:"Block",props:{x:Number,y:Number,name:String,settings:Array,inputs:Array,outputs:Array},data:function(){return{dragging:!1,linking:!1,lastMouseX:0,lastMouseY:0,tx:0,ty:0,height:0,width:0}},mounted:function(){this.height=this.$el.offsetHeight,this.width=this.$el.offsetWidth,this.$emit("init",this.height,this.width),document.documentElement.addEventListener("mousemove",this.mouseMove,!0),document.documentElement.addEventListener("mousedown",this.mouseDown,!0),document.documentElement.addEventListener("mouseup",this.mouseUp,!0)},beforeDestroy:function(){document.documentElement.removeEventListener("mousemove",this.mouseMove,!0),document.documentElement.removeEventListener("mousedown",this.mouseDown,!0),document.documentElement.removeEventListener("mouseup",this.mouseUp,!0)},methods:{mouseDown:function(t){this.$el.contains(t.target)&&(t.target.classList.contains("tag")||(this.lastMouseX=t.pageX,this.lastMouseY=t.pageY,this.tx=this.x,this.ty=this.y,this.dragging=!0))},mouseUp:function(t){this.dragging&&(this.$emit("drop-block",this.tx,this.ty,this.height,this.width),this.dragging=!1),this.linking&&!t.target.classList.contains("tag")&&this.$emit("stop-link",t,"",-1),this.linking=!1},mouseMove:function(t){if(this.dragging){var n=this.lastMouseX,e=this.lastMouseY;this.lastMouseX=t.pageX,this.lastMouseY=t.pageY,this.tx+=this.lastMouseX-n,this.ty+=this.lastMouseY-e,this.$emit("mousemove",this.tx,this.ty,this.height,this.width)}else this.linking&&this.$emit("move-link",t)},startLink:function(t,n,e,i){this.linking=!0,this.$emit("start-link",t,n,e,i)},stopLink:function(t,n,e,i){this.linking=!1,this.$emit("stop-link",t,n,e,i)},updateSetting:function(t,n,e){this.$emit("update-setting",n.name,Number(t.target.value))},clickSetting:function(t,n,e){this.$emit("click-setting",n.name)}}},$={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"block",style:{left:(t.dragging?t.tx:t.x)+"px",top:(t.dragging?t.ty:t.y)+"px"}},[e("div",{staticClass:"box"},[e("div",{staticClass:"inputs"},t._l(t.inputs,function(n,i){return e("div",{key:t.name+"i"+n.name},[e("span",{staticClass:"tag",on:{mousedown:function(e){t.startLink(e,"input",i,n.name)},mouseup:function(e){t.stopLink(e,"input",i,n.name)}}},[t._v(t._s(n.name))])])})),t._v(" "),e("div",{staticClass:"block-content"},[e("h1",{staticClass:"title"},[t._v(t._s(t.name))]),t._v(" "),t._l(t.settings,function(n,i){return e("div",{staticClass:"field",on:{click:function(e){t.clickSetting(e,n,i)}}},[e("label",{staticClass:"label"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"control"},[e("input",{staticClass:"input is-rounded",attrs:{type:"number"},domProps:{value:n.value},on:{input:function(e){t.updateSetting(e,n,i)}}})])])})],2),t._v(" "),e("div",{staticClass:"outputs"},t._l(t.outputs,function(n,i){return e("div",{key:t.name+"o"+n.name},[e("span",{staticClass:"tag",on:{mousedown:function(e){t.startLink(e,"output",i,n.name)},mouseup:function(e){t.stopLink(e,"output",i,n.name)}}},[t._v(t._s(n.name))])])}))])])},staticRenderFns:[]};var M=e("VU/8")(w,$,!1,function(t){e("tX24")},"data-v-936ad5d4",null).exports,L={name:"BlockLink",props:{p0:Object,p1:Object},computed:{d:function(){var t=this.p0.x,n=this.p0.y,e=this.p1.x,i=this.p1.y;return"M"+t+","+n+" L"+(.05*Math.abs(e-t)+t)+","+n+" C"+(t+.33*Math.abs(e-t))+","+n+" "+(e-.33*Math.abs(e-t))+","+i+" "+(-1*Math.abs(e-t)*.05+e)+","+i+" L"+e+","+i}},data:function(){return{}}},A={render:function(){var t=this.$createElement,n=this._self._c||t;return n("svg",{staticClass:"block-link"},[n("path",{attrs:{d:this.d}})])},staticRenderFns:[]};var E=e("VU/8")(L,A,!1,function(t){e("iqNx")},"data-v-7f669988",null).exports;function S(t,n,e,i,a,s,o,c,r){return{y:n+(e-(r*(o+c)-c))/2+(o+c)*a+o/2,x:t+("input"===s?0:i)}}var O={name:"BlocksContainer",props:{rawBlocks:Array},computed:{blocks:function(){var t=[];for(var n in this.rawBlocks){var e=this.rawBlocks[n];this.blocksMeta[e.name]&&(e=x()({},e,this.blocksMeta[e.name])),t.push(e)}return t}},data:function(){return{links:{},tmpLink:null,blocksMeta:{}}},methods:{mouseMove:function(t,n,e,i){t.x=e,t.y=i,this.updateLinks(t,n)},init:function(t,n,e,i){this.$set(this.blocksMeta,t.name,{width:i,height:e}),t.width=i,t.height=e,this.updateLinks(t,n)},dropBlock:function(t,n,e,i){t.x=e,t.y=i,this.$emit("drop-block",t),this.$set(this.blocksMeta[t.name],"dragging",!1)},dragStart:function(t,n){this.$set(this.blocksMeta[t.name],"dragging",!0)},startLink:function(t,n,e,i,a,s){this.tmpLink="output"===i?{block:t,type:i,index:a,name:s,p0:S(t.x,t.y,t.height,t.width,a,i,24,1,t[i+"s"].length),p1:{x:e.pageX-this.$el.offsetLeft,y:e.pageY-this.$el.offsetTop}}:{block:t,type:i,index:a,name:s,p0:{x:e.pageX-this.$el.offsetLeft,y:e.pageY-this.$el.offsetTop},p1:S(t.x,t.y,t.height,t.width,a,i,24,1,t[i+"s"].length)}},moveLink:function(t,n,e){"output"===this.tmpLink.type?this.tmpLink.p1={x:e.pageX-this.$el.offsetLeft,y:e.pageY-this.$el.offsetTop}:this.tmpLink.p0={x:e.pageX-this.$el.offsetLeft,y:e.pageY-this.$el.offsetTop}},stopLink:function(t,n,e,i,a,s){var o=this.tmpLink.block,c=this.tmpLink.type,r=this.tmpLink.name,l=this.tmpLink.index;if(this.tmpLink=null,-1!==a&&i!==c){if("input"===c){var u=[t,o];o=u[0],t=u[1];var d=[a,l];l=d[0],a=d[1];var m=[s,r];r=m[0],s=m[1]}t.inputs[a].linkedTo||this.$emit("new-link",{inputBlockName:t.name,inputName:s,outputBlockName:o.name,outputName:r})}},updateLinks:function(t,n){var e=this,i={},a=!0,s=!1,o=void 0;try{for(var c,r=N()(this.blocks);!(a=(c=r.next()).done);a=!0){var l=c.value;i[l.name]=l}}catch(t){s=!0,o=t}finally{try{!a&&r.return&&r.return()}finally{if(s)throw o}}for(var u in t.outputs){var d=t.name+t.outputs[u].name;this.links[d]&&(this.links[d].p0=S(t.x,t.y,t.height,t.width,u,"output",24,1,t.outputs.length))}var m=function(n){var a=t.inputs[n];if(a.linkedTo){var s=a.linkedTo.blockName+a.linkedTo.outputName;if(!e.links[s]){var o=i[a.linkedTo.blockName],c=o.outputs.findIndex(function(t){return t.name===a.linkedTo.outputName});e.$set(e.links,s,{p1:{x:0,y:0},p0:S(o.x,o.y,o.height,o.width,c,"output",24,1,o.outputs.length)})}e.links[s].p1=S(t.x,t.y,t.height,t.width,n,"input",14,10,t.inputs.length)}};for(var h in t.inputs)m(h)},updateSetting:function(t,n,e,i){this.$emit("update-setting",{blockName:t.name,name:e,value:i})},clickSetting:function(t,n,e){this.$emit("click-setting",{blockName:t.name,name:e})}},components:{Block:M,BlockLink:E}},B={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"blocks-container"},[null!==t.tmpLink?e("block-link",{attrs:{p0:t.tmpLink.p0,p1:t.tmpLink.p1}}):t._e(),t._v(" "),t._l(t.links,function(t,n){return e("block-link",{attrs:{p0:t.p0,p1:t.p1}})}),t._v(" "),t._l(t.blocks,function(n,i){return e("block",{attrs:{x:n.x,y:n.y,name:n.name,settings:n.settings,inputs:n.inputs,outputs:n.outputs},on:{"drop-block":function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];return t.dropBlock.apply(void 0,[n,i].concat(e))},"drag-start":function(e){t.dragStart(n,i)},"click-setting":function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];return t.clickSetting.apply(void 0,[n,i].concat(e))},"update-setting":function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];return t.updateSetting.apply(void 0,[n,i].concat(e))},mousemove:function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];return t.mouseMove.apply(void 0,[n,i].concat(e))},init:function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];return t.init.apply(void 0,[n,i].concat(e))},"move-link":function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];return t.moveLink.apply(void 0,[n,i].concat(e))},"start-link":function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];return t.startLink.apply(void 0,[n,i].concat(e))},"stop-link":function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];return t.stopLink.apply(void 0,[n,i].concat(e))}}})})],2)},staticRenderFns:[]};var I=e("VU/8")(O,B,!1,function(t){e("4CKQ")},"data-v-127aeef6",null).exports,U={name:"AddThingDropdown",props:{track:Object},data:function(){return{thing:null,thingName:null}},computed:Object(k.c)({things:function(t){return t.things}}),methods:{openAddThingModal:function(t){this.thing=t},closeAddThingModal:function(){this.thing=null,this.thingName=null},addThing:function(){this.$socket.emit("createThing",p()({trackName:this.track.name,name:this.thingName,kind:this.thing})),this.thing=null,this.thingName=null}}},F={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"add-thing-dropdown"},[e("div",{staticClass:"dropdown is-hoverable"},[e("div",{staticClass:"dropdown-trigger"},[e("button",{staticClass:"button is-large is-primary is-inverted",attrs:{"aria-haspopup":"true","aria-controls":"add-thing-menu"}},[e("span",{staticClass:"icon"},[e("fa",{attrs:{icon:"plus"}})],1),t._v(" "),e("span",[t._v("Add a thing")])]),t._v(" "),e("div",{staticClass:"dropdown-menu",attrs:{id:"add-thing-menu",role:"menu"}},[e("div",{staticClass:"dropdown-content"},t._l(t.things,function(n){return e("a",{key:n,staticClass:"dropdown-item",on:{click:function(e){t.openAddThingModal(n)}}},[t._v("\n            "+t._s(n)+"\n          ")])}))])])]),t._v(" "),e("div",{staticClass:"modal",class:[{"is-active":null!==t.thing}]},[e("div",{staticClass:"modal-background",on:{click:t.closeAddThingModal}}),t._v(" "),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"box"},[e("h1",{staticClass:"title",staticStyle:{color:"#000"}},[t._v("Add a "),e("strong",[t._v(t._s(t.thing))])]),t._v(" "),e("form",{on:{submit:t.addThing}},[e("div",{staticClass:"field"},[e("label",{staticClass:"label"},[t._v("Thing name")]),t._v(" "),e("div",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.thingName,expression:"thingName"}],staticClass:"input",attrs:{type:"text",placeholder:"Thing name"},domProps:{value:t.thingName},on:{input:function(n){n.target.composing||(t.thingName=n.target.value)}}})])]),t._v(" "),t._m(0)])])]),t._v(" "),e("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:t.closeAddThingModal}})])])},staticRenderFns:[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"control"},[n("button",{staticClass:"button is-primary"},[this._v("Add thing")])])}]},X=e("VU/8")(U,F,!1,null,null,null).exports,D={name:"TrackScreen",props:{track:Object},computed:{blocks:function(){var t=[{name:"Output",inputs:[{name:"main"}],x:0,y:0,outputs:[]}];if(!this.track.things)return t;if(this.track.outputs){var n=!0,e=!1,i=void 0;try{for(var a,s=N()(this.track.outputs);!(n=(a=s.next()).done);n=!0){var o=a.value;t[0].inputs[0].linkedTo={blockName:o.thingName,outputName:o.name}}}catch(t){e=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(e)throw i}}}var c=!0,r=!1,l=void 0;try{for(var u,d=N()(this.track.things);!(c=(u=d.next()).done);c=!0){var m=u.value;for(var h in m.inputs)m.inputs[h].linkedTo&&(m.inputs[h].linkedTo.blockName=m.inputs[h].linkedTo.thingName);t.push(m)}}catch(t){r=!0,l=t}finally{try{!c&&d.return&&d.return()}finally{if(r)throw l}}return t}},data:function(){return{}},methods:{newLink:function(t){"Output"===t.inputBlockName?this.$socket.emit("attachToTrack",p()({trackName:this.track.name,thingName:t.outputBlockName,name:t.outputName})):this.$socket.emit("attachToThing",p()({trackName:this.track.name,outputThingName:t.outputBlockName,inputThingName:t.inputBlockName,outputName:t.outputName,inputName:t.inputName}))},dropThing:function(t){this.$socket.emit("updateThingsPosition",p()({trackName:this.track.name,name:t.name,x:t.x,y:t.y}))},updateSetting:function(t){this.$socket.emit("updateSetting",p()({trackName:this.track.name,thingName:t.blockName,name:t.name,value:t.value}))},clickSetting:function(t){this.$store.state.midi&&(this.$store.state.midi=!1,this.$socket.emit("attachToMIDI",p()({trackName:this.track.name,thingName:t.blockName,name:t.name})))}},components:{BlocksContainer:I,AddThingDropdown:X}},Y={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"track-screen"}},[e("section",{staticClass:"hero is-primary"},[e("div",{staticClass:"hero-body"},[e("div",{staticClass:"container"},[e("div",{staticClass:"columns"},[e("div",{staticClass:"column"},[e("h1",{staticClass:"title"},[t._v(t._s(t.track.name))]),t._v(" "),e("h2",{staticClass:"subtitle"},[t._v("Such a perfect track")])]),t._v(" "),e("div",{staticClass:"column is-narrow"},[e("add-thing-dropdown",{attrs:{track:t.track}})],1)])])])]),t._v(" "),e("blocks-container",{attrs:{"raw-blocks":t.blocks},on:{"drop-block":t.dropThing,"click-setting":t.clickSetting,"update-setting":t.updateSetting,"new-link":t.newLink}})],1)},staticRenderFns:[]};var V=e("VU/8")(D,Y,!1,function(t){e("7hNF")},"data-v-0f594da4",null).exports,R={name:"Home",data:function(){return{}},computed:Object(k.b)(["selectedTrack"]),components:{Tracks:C,TrackScreen:V}},j={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"columns",attrs:{id:"home"}},[n("div",{staticClass:"column is-one-quarter"},[n("tracks")],1),this._v(" "),n("div",{staticClass:"column"},[null!==this.selectedTrack?n("track-screen",{attrs:{track:this.selectedTrack}}):n("div",{staticClass:"container"},[n("h1",{staticClass:"title is-1 is-spaced"},[this._v("No track selected.")]),this._v(" "),n("h3",{staticClass:"subtitle is-3"},[this._v("NOISE cannot play music.")])])],1)])},staticRenderFns:[]};var H=e("VU/8")(R,j,!1,function(t){e("95AV")},"data-v-1408de5c",null).exports;a.a.use(m.a);var K=new m.a({routes:[{path:"/",name:"Home",component:H}]}),P=e("mUbh"),q=function(t,n){t.socket.isConnected=!0},J=function(t,n){t.socket.isConnected=!1},Q=function(t,n){var e=JSON.parse(n).state;t.state=e},W=function(t,n){t.things=JSON.parse(n).things};a.a.use(k.a);var Z={selectedTrack:function(t){if(!t.selectedTrackName||!t.state.tracks)return null;var n=!0,e=!1,i=void 0;try{for(var a,s=N()(t.state.tracks);!(n=(a=s.next()).done);n=!0){var o=a.value;if(o.name===t.selectedTrackName)return o}}catch(t){e=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(e)throw i}}return null}},G=new k.a.Store({state:{socket:{isConnected:!1},selectedTrackName:null,state:{tracks:[]},things:[],midi:!1},getters:Z,actions:P,mutations:i});a.a.config.productionTip=!1,c.library.add(r.a,r.b),a.a.component("fa",l.FontAwesomeIcon),a.a.use(d.a,"http://localhost:4242",G),new a.a({el:"#app",router:K,store:G,components:{App:o},template:"<App/>"})},iqNx:function(t,n){},mUbh:function(t,n){},tX24:function(t,n){},vsZE:function(t,n){}},["NHnr"]);
//# sourceMappingURL=app.4d51954cd7539dd55314.js.map